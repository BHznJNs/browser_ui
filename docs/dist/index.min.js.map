{"version":3,"file":"index.min.js","sources":["../../frontend/scripts/resourceFetcher.js","../../frontend/scripts/importers/style.js","../../frontend/scripts/importers/highlight.js","../../frontend/scripts/importers/katex.js","../../frontend/scripts/importers/umd.js","../../frontend/scripts/importers/charts/flowchart.js","../../frontend/scripts/importers/charts/sequence.js","../../frontend/scripts/importers/charts/gantt.js","../../frontend/scripts/importers/charts/railroad.js","../../common/removeUndefinedFields.js","../../frontend/scripts/importers/charts/qrcode.js","../../frontend/scripts/importers/charts/index.js","../../frontend/scripts/iframeController.js","../../frontend/utils/dom/el.js","../../common/countWord.js","../../frontend/utils/markdown/utils/getInterval.js","../../frontend/utils/markdown/inline.js","../../frontend/utils/markdown/node.js","../../frontend/utils/markdown/utils/getIndent.js","../../frontend/utils/markdown/resolvers/listResolver.js","../../frontend/utils/markdown/resolvers/quoteResolver.js","../../frontend/utils/markdown/resolvers/tableResolver.js","../../frontend/utils/markdown/resolvers/QAResolver.js","../../frontend/utils/markdown/resolvers/blockResolvers.js","../../frontend/utils/markdown/index.js","../../frontend/utils/markdown/utils/getLines.js","../../frontend/utils/dom/keydownEvent.js","../../frontend/utils/dom/scrollControl.js","../../common/isEnabled.js","../../frontend/scripts/articleRenderer.js","../../frontend/utils/dateFormatter.js","../../frontend/scripts/indexRenderer.js","../../frontend/scripts/importers/prefetch.js","../../frontend/scripts/pathManager.js","../../frontend/components/paging.js","../../frontend/scripts/mainManager.js","../../frontend/utils/liveReload.js","../../frontend/index.js"],"sourcesContent":["let controller = null\r\n\r\nexport async function fetchJSON(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            const json = await res.json()\r\n            controller = null\r\n            return json\r\n        })\r\n        .catch(err => {\r\n            console.log(\"JSON request error: \" + path)\r\n            console.error(err)\r\n            return null\r\n        })\r\n}\r\n\r\nexport async function fetchMD(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            if (res.status != 200) {\r\n                throw res.status\r\n            }\r\n            const text = await res.text()\r\n            controller = null\r\n            return text\r\n        })\r\n        .catch(err => {\r\n            if (typeof err != \"number\") {\r\n                console.error(err)\r\n                return null\r\n            }\r\n\r\n            switch (err) {\r\n                // render error code in markdown format\r\n                case 404:\r\n                    return \"# 404 Not Found\"\r\n                case 500:\r\n                    return \"# 500 Internal Server Error\"\r\n                case DOMException:\r\n                    console.error(err)\r\n                    break\r\n                default:\r\n                    console.log(\"Markdown request error: \" + path)\r\n                    console.error(err)\r\n                    return \"# Unexpected request error\"\r\n            }\r\n        })\r\n}\r\n","export default function importStyle(path) {\r\n    return new Promise((resolve, reject) => {\r\n        const linkEl = document.createElement(\"link\")\r\n        linkEl.rel  = \"stylesheet\"\r\n        linkEl.href = path\r\n        document.head.appendChild(linkEl)\r\n\r\n        linkEl.onload = resolve\r\n        linkEl.onerror = reject\r\n    })\r\n}\r\n","import DynamicImporter from \"./dynamicImporter.js\"\r\nimport importStyle from \"./style.js\"\r\n\r\nclass HighlightImporter extends DynamicImporter {\r\n    name = \"Highlight.js\"\r\n    _targetElList = () => document.querySelectorAll(\"pre.code-block code\")\r\n\r\n    async #importLangDefs(languageList=[]) {\r\n        const langDefImporters = languageList\r\n            .filter(name => !this._module.getLanguage(name))\r\n            .map(lang => import(`../../libs/highlight-es/languages/${lang.toLowerCase()}.js`))\r\n        await Promise.all(langDefImporters)\r\n            .then(langDefs => langDefs.forEach((defModule, index) => {\r\n                const name = languageList[index]\r\n                const def  = defModule.default\r\n                this._module.registerLanguage(name, def)\r\n            }))\r\n            .catch(this.loadErrResolver)\r\n    }\r\n\r\n    loadCondition(languageList) {\r\n        return languageList.size > 0\r\n    }\r\n\r\n    renderItem(el) {\r\n        this._module.highlightElement(el)\r\n    }\r\n    async beforeRender(languageList=new Set()) {\r\n        await this.#importLangDefs(Array.from(languageList))\r\n    }\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/highlight-es/github-dark.css\")\r\n        const module = await import(\"../../libs/highlight-es/highlight.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new HighlightImporter()\r\nexport default inst.render.bind(inst)\r\n","import importStyle from \"./style.js\"\r\nimport DynamicImporter from \"./dynamicImporter.js\"\r\nimport { config } from \"../../utils/loadConfig.js\"\r\n\r\nconst { katexOptions } = config\r\n\r\nclass KatexImporter extends DynamicImporter {\r\n    name = \"KaTeX\"\r\n    _targetElList = () => document.querySelectorAll(\".math\")\r\n\r\n    loadCondition(isContainsFormula) {\r\n        return isContainsFormula\r\n    }\r\n\r\n    renderErrResolver(err, el) {\r\n        const texString = el.textContent\r\n        if (err instanceof this._module.ParseError) {\r\n            // KaTeX can't parse the expression\r\n            el.innerHTML = (\"Error in LaTeX '\" + texString + \"': \" + err.message)\r\n                .replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n        } else {\r\n            // other error\r\n            el.textContent = this.name + \" \" + DynamicImporter.renderErrMsg\r\n            console.error(err)\r\n        }\r\n    }\r\n    renderItem(el) {\r\n        const texString = el.textContent\r\n        this._module.render(texString, el, katexOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/katex/katex.min.css\")\r\n        const module = await import(\"../../libs/katex/katex.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new KatexImporter()\r\nexport default inst.render.bind(inst)\r\n","export default function umdImporter(path, name) {\r\n    const scriptEl = document.createElement(\"script\")\r\n    scriptEl.src   = path\r\n    scriptEl.type  = \"text/javascript\"\r\n    document.head.appendChild(scriptEl)\r\n    return new Promise((resolve, reject) => {\r\n        scriptEl.onload = function() {\r\n            if (!(name in globalThis)) {\r\n                const errMsg = `Module ${name} does not support this import method.`\r\n                console.error(errMsg)\r\n                reject(errMsg)\r\n            }\r\n\r\n            const localModuleObj = globalThis[name]\r\n            globalThis[name] = undefined\r\n            resolve(localModuleObj)\r\n        }\r\n        scriptEl.onerror = function(err) {\r\n            console.error(`Error loading dynamically imported module \"${name}\": ${path}`)\r\n            reject(err)\r\n        }\r\n    })\r\n}\r\n","import ChartImporter from \"./importer.js\"\r\nimport umdImporter from \"../umd.js\"\r\nimport { config } from \"../../../utils/loadConfig.js\"\r\n\r\nglobalThis.raphael = null\r\nconst { flowchartOptions } = config\r\n\r\nclass FlowchartImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".flowchart-container\")\r\n\r\n    constructor() { super() }\r\n\r\n    renderItem(el, chartContent) {\r\n        const chartInst = this._module.parse(chartContent)\r\n        chartInst.drawSVG(el, flowchartOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        globalThis.raphael = await umdImporter(\"./dist/libs/flowchart.js/raphael.min.js\", \"raphael\")\r\n        const flowchartModule = await umdImporter(\"./dist/libs/flowchart.js/flowchart.min.js\", \"flowchart\")\r\n        return flowchartModule\r\n    }\r\n}\r\n\r\nconst inst = new FlowchartImporter()\r\nexport default inst.render.bind(inst)\r\n","import ChartImporter from \"./importer.js\"\r\n\r\nclass SequenceImport extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".sequencechart-container\")\r\n\r\n    constructor() { super() }\r\n\r\n    renderItem(el, chartContent) {\r\n        const diagram = new this._module(chartContent)\r\n        el.appendChild(diagram.dom())\r\n    }\r\n\r\n    async importModule() {\r\n        const module = await import(\"../../../libs/sequence-diagram/sequence-diagram-web.mjs\")\r\n        return module.SequenceDiagram\r\n    }\r\n}\r\n\r\nconst inst = new SequenceImport()\r\nexport default inst.render.bind(inst)\r\n","import ChartImporter from \"./importer.js\"\r\nimport importStyle from \"../style.js\"\r\nimport { config } from \"../../../utils/loadConfig.js\"\r\n\r\nconst { language, ganttOptions } = config\r\nlet globalOptions = ganttOptions ?? {}\r\n\r\nif (!(\"language\" in globalOptions)) {\r\n    // set language of gantt charts as default\r\n    globalOptions.language = language\r\n}\r\n\r\nclass GanttImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".ganttchart-container\")\r\n\r\n    renderItem(el, chartContent) {\r\n        new this._module(el, chartContent, globalOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/frappe-gantt/frappe-gantt.min.css\")\r\n        const module = await import(\"../../../libs/frappe-gantt/frappe-gantt.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new GanttImporter()\r\nexport default inst.render.bind(inst)\r\n","import importStyle from \"../style.js\"\r\nimport ChartImporter from \"./importer.js\"\r\nimport { config } from \"../../../utils/loadConfig.js\"\r\nimport removeUndefinedFields from \"../../../../common/removeUndefinedFields.js\"\r\n\r\nlet railroadRenderOptions = null\r\nconst globalOptions = config.railroadOptions ?? {}\r\nconst ASCIIPattern = /[\\x00-\\x7F]/\r\nconst CJKPattern   = /['\"]([^'\"]*[/\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}]+[^'\"]*)['\"]/gu\r\n\r\nclass RailroadImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".railroad-container\")\r\n\r\n    renderItem(el, chartContent=\"\") {\r\n        const CHAR_WIDTH_before = railroadRenderOptions.CHAR_WIDTH\r\n        const containsCJK = CJKPattern.test(chartContent)\r\n        const isAllContainsASCII = (chartContent.match(CJKPattern) || [])\r\n            .map(matchItem => matchItem.slice(1, -1))\r\n            .every(item => ASCIIPattern.test(item))\r\n        const targetCharWidth = containsCJK\r\n            && (isAllContainsASCII ? 13 : 14)\r\n            || railroadRenderOptions.CHAR_WIDTH\r\n        if (railroadRenderOptions.CHAR_WIDTH < targetCharWidth) {\r\n            railroadRenderOptions.CHAR_WIDTH = targetCharWidth\r\n        }\r\n\r\n        const renderArgs = this._module.concat(el)\r\n        const renderFn = new Function(\r\n            \"Diagram\",\r\n            \"ComplexDiagram\",\r\n            \"Sequence\",\r\n            \"Stack\",\r\n            \"OptionalSequence\",\r\n            \"AlternatingSequence\",\r\n            \"Choice\",\r\n            \"HorizontalChoice\",\r\n            \"MultipleChoice\",\r\n            \"Optional\",\r\n            \"OneOrMore\",\r\n            \"ZeroOrMore\",\r\n            \"Group\",\r\n            \"Start\",\r\n            \"End\",\r\n            \"Terminal\",\r\n            \"NonTerminal\",\r\n            \"Comment\",\r\n            \"Skip\",\r\n            \"Block\",\r\n            \"targetElement\",\r\n            chartContent + \".addTo(targetElement)\",\r\n        )\r\n        renderFn.apply(null, renderArgs)\r\n        // restore CHAR_WIDTH\r\n        railroadRenderOptions.CHAR_WIDTH = CHAR_WIDTH_before\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/railroad-diagrams/railroad.css\")\r\n        const module = await import(\"../../../libs/railroad-diagrams/railroad.min.js\")\r\n        const {\r\n            default: rr,\r\n            Options,\r\n        } = module\r\n        Object.assign(Options, removeUndefinedFields({\r\n            VS                : globalOptions.verticalGap,\r\n            AR                : globalOptions.arcRadius,\r\n            INTERNAL_ALIGNMENT: globalOptions.internalAlignment,\r\n            CHAR_WIDTH        : globalOptions.charWidth,\r\n            COMMENT_CHAR_WIDTH: globalOptions.commentCharWidth,\r\n        }))\r\n        railroadRenderOptions = Options\r\n        return [\r\n            rr.Diagram,\r\n            rr.ComplexDiagram,\r\n            rr.Sequence,\r\n            rr.Stack,\r\n            rr.OptionalSequence,\r\n            rr.AlternatingSequence,\r\n            rr.Choice,\r\n            rr.HorizontalChoice,\r\n            rr.MultipleChoice,\r\n            rr.Optional,\r\n            rr.OneOrMore,\r\n            rr.ZeroOrMore,\r\n            rr.Group,\r\n            rr.Start,\r\n            rr.End,\r\n            rr.Terminal,\r\n            rr.NonTerminal,\r\n            rr.Comment,\r\n            rr.Skip,\r\n            rr.Block,\r\n        ]\r\n    }\r\n}\r\n\r\nconst inst = new RailroadImporter()\r\nexport default inst.render.bind(inst)\r\n","/**\r\n * @param {object} obj original object that may have undefined fields\r\n * @returns {object} new object that without undefined fields\r\n */\r\nexport default function removeUndefinedFields(obj) {\r\n    const newObj = {}\r\n    for (const key in obj) {\r\n        if (obj.hasOwnProperty(key) && obj[key] !== undefined) {\r\n            newObj[key] = obj[key]\r\n        }\r\n    }\r\n    return newObj\r\n}\r\n","import umdImporter from \"../umd.js\"\r\nimport ChartImporter from \"./importer.js\"\r\nimport { config } from \"../../../utils/loadConfig.js\"\r\n\r\nconst { qrcodeOptions: globalOptions } = config\r\n\r\nclass QRCodeImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".qrcode-container\")\r\n\r\n    // dark mode event listener\r\n    #darkmodeObserver = new MutationObserver(this.renderAll.bind(this))\r\n\r\n    renderItem(el) {\r\n        // get current front color and background color\r\n        const computedStyle    = getComputedStyle(document.body)\r\n        const frontColor       = computedStyle.getPropertyValue(\"--default-tx-color\")\r\n        const backgroundColor  = computedStyle.getPropertyValue(\"--chart-bg-color\")\r\n\r\n        const instOptions      = Object.assign({}, globalOptions)\r\n        const qrcodeContent    = el.__QRCodeContent__\r\n        const qrcodeWidth      = instOptions.width || 256 // default width\r\n        instOptions.color      = frontColor\r\n        instOptions.background = backgroundColor\r\n        instOptions.content    = qrcodeContent\r\n            || instOptions.content // global qrcode content\r\n            || (() => {throw new Error(\"No QRCode content provided.\")})()\r\n\r\n        const qrcodeInst = new this._module(instOptions)\r\n        el.style.width   = qrcodeWidth + \"px\"\r\n        el.innerHTML     = qrcodeInst.svg()\r\n    }\r\n\r\n    async importModule() {\r\n        const QRCode = await umdImporter(\"./dist/libs/qrcode-svg/qrcode.min.js\", \"QRCode\")\r\n        const body = document.body\r\n        this.#darkmodeObserver.observe(body, {\r\n            attributes: true,\r\n            attributeFilter: [\"class\"]\r\n        })\r\n        return QRCode\r\n    }\r\n}\r\n\r\nconst inst = new QRCodeImporter()\r\nexport default inst.render.bind(inst)\r\n","import echartsRender from \"./echarts.js\"\r\nimport flowchartRender from \"./flowchart.js\"\r\nimport sequenceChartRender from \"./sequence.js\"\r\nimport ganttChartRender from \"./gantt.js\"\r\nimport railroadChartRender from \"./railroad.js\"\r\nimport qrcodeRender from \"./qrcode.js\"\r\n\r\nconst chartMethodMap = new Map([\r\n    [\"echarts\"       , echartsRender],\r\n    [\"flow-chart\"    , flowchartRender],\r\n    [\"sequence-chart\", sequenceChartRender],\r\n    [\"gantt-chart\"   , ganttChartRender],\r\n    [\"railroad-chart\", railroadChartRender],\r\n    [\"qrcode\"        , qrcodeRender],\r\n])\r\n\r\nexport default async function(chartTypeList=new Set()) {\r\n    for (const type of chartTypeList) {\r\n        if (!chartMethodMap.has(type)) {\r\n            console.error(\"Unknown chart type: \" + type)\r\n            continue\r\n        }\r\n        const targetChartLoadMethod = chartMethodMap.get(type)\r\n        await targetChartLoadMethod()\r\n    }\r\n}\r\n","const embeddedIframes = () => document.querySelectorAll(\"iframe[srcdoc]\")\r\n\r\nexport function setIframeRem(fontSize) {\r\n    embeddedIframes().forEach(el =>\r\n        el.contentWindow.postMessage({ fontSize }, \"*\"))\r\n}\r\n\r\nexport async function allIframeLoaded() {\r\n    const loadEvents = Array.from(embeddedIframes()).map(el => {\r\n        return new Promise((resolve, _) => el.onload = resolve)\r\n    })\r\n    await Promise.all(loadEvents)\r\n}\r\n\r\nexport function setIframeTheme() {\r\n    const isDarkMode      = document.body.classList.contains(\"dark\")\r\n    const theme           = isDarkMode ? \"dark\" : \"light\"\r\n    embeddedIframes().forEach(el =>\r\n        el.contentWindow.postMessage({ theme }, \"*\"))\r\n}\r\n","function propSetter(el, props) {\r\n    if (!props) {\r\n        return\r\n    }\r\n    for (const [key, val] of Object.entries(props)) {\r\n        if (val === undefined || val === false) {\r\n            continue\r\n        }\r\n        if (val instanceof Function) {\r\n            el[key] = val\r\n        } else\r\n        if (val instanceof Array) {\r\n            el.setAttribute(key, val.join(\" \"))\r\n        } else {\r\n            el.setAttribute(key, val)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * { prop: \"value\" } => \"prop='value'\"\r\n * @param {Object} props \r\n * @returns {string}\r\n */\r\nfunction propToString(props) {\r\n    function htmlValueFormater(val) {\r\n        if (val === undefined) {\r\n            return ''\r\n        }\r\n        if (val instanceof Array) {\r\n            return val.join(\" \").replaceAll(\"\\\"\", \"&quot;\")\r\n        }\r\n        return val.toString().replaceAll(\"\\\"\", \"&quot;\")\r\n    }\r\n\r\n    const resultPropStr = Object.entries(props)\r\n        .filter(([_, val]) => val !== undefined || val !== false)\r\n        .map(([key, val]) => {\r\n            if (typeof val === \"boolean\") { return key }\r\n            return`${key}=\"${htmlValueFormater(val)}\"`})\r\n        .join(\" \")\r\n    return resultPropStr\r\n}\r\n\r\nfunction contentSetter(el, content) {\r\n    if (content instanceof Array) {\r\n        // array of html element\r\n        for (const childEl of content) {\r\n            if (typeof childEl === \"string\") {\r\n                el.appendChild(document.createTextNode(childEl))\r\n            } else {\r\n                el.appendChild(childEl)\r\n            }\r\n        }\r\n    } else if (content instanceof HTMLElement) {\r\n        // single element\r\n        el.appendChild(content)\r\n    } else if (typeof content === \"string\") {\r\n        // common text\r\n        el.textContent = content\r\n    } else {\r\n        throw Error(\"Unexpected element content: \" + content)\r\n    }\r\n}\r\n\r\nfunction selfClosingTag(tagName, props) {\r\n    return `<${tagName}${props ? \" \" + propToString(props) : \"\"}>`\r\n}\r\n\r\n/**\r\n * @param {string} tagName\r\n * @param {string | object} content\r\n */\r\nexport default function el(tagName, content=\"\", props=null) {\r\n    const isContentPlainObj = content !== null\r\n        && typeof content === \"object\"\r\n        && content.constructor === Object\r\n    if (isContentPlainObj) {\r\n        // allow pass props as content\r\n        props = content\r\n        content = \"\"\r\n    }\r\n\r\n    if (\"document\" in globalThis) {\r\n        // in browser\r\n        if (tagName === \"text\") {\r\n            return document.createTextNode(content)\r\n        }\r\n\r\n        const targetEl = document.createElement(tagName)\r\n        propSetter(targetEl, props)\r\n        contentSetter(targetEl, content)\r\n        return targetEl\r\n    } else {\r\n        // in node.js\r\n        if (content instanceof Array) {\r\n            content = content.join(\"\")\r\n        }\r\n        switch (tagName) {\r\n            case \"text\":\r\n                return content\r\n            case \"hr\":\r\n            case \"br\":\r\n                return selfClosingTag(tagName)\r\n            case \"img\":\r\n            case \"input\":\r\n                return selfClosingTag(tagName, props)\r\n        }\r\n        return `<${tagName}${props ? \" \" + propToString(props) : \"\"}>${content}</${tagName}>`\r\n    }\r\n}\r\n","const cjkCharPattern = /[\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}]/gu\r\nconst euCharPattern  = /[A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u00FF]+/g\r\nconst grCharPattern  = /\\p{Script=Greek}+/gu\r\nconst arCharPattern  = /\\p{Script=Arabic}+/gu\r\nconst cyCharPattern  = /\\p{Script=Cyrillic}+/gu\r\nconst numberPattern  = /(\\-|\\+)?\\d+(\\.\\d+)?/g\r\n\r\nconst patternList = [\r\n    cjkCharPattern,\r\n    euCharPattern,\r\n    grCharPattern,\r\n    arCharPattern,\r\n    cyCharPattern,\r\n    numberPattern,\r\n]\r\n\r\nexport function tokenize(para=\"\") {\r\n    if (para.length === 0) {\r\n        return []\r\n    }\r\n\r\n    const tokenList = patternList\r\n        .map(pattern => {\r\n            const matched = para.match(pattern)\r\n            return matched || []\r\n        })\r\n        .reduce((accumulator, current) =>\r\n            accumulator.concat(current)\r\n        , [])\r\n\r\n    return tokenList\r\n}\r\n\r\nexport default function countWord(para=\"\") {\r\n    if (para.length === 0) {\r\n        return 0\r\n    }\r\n\r\n    const tokenList  = tokenize(para)\r\n    return tokenList.length\r\n}","// (\"abc]\", \"]\") -> \"abc\"\r\nexport default function getInterval(text, startSign, endSign, includeEscape=false) {\r\n    if (!text.includes(endSign)) {\r\n        return null\r\n    }\r\n\r\n    let intervalText = \"\"\r\n    let signCount = 0\r\n    let isEscape = false\r\n\r\n    while (text.length) {\r\n        const ch = text.slice(0, 1)\r\n        text = text.substr(1)\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            if (!includeEscape) {\r\n                continue\r\n            }\r\n        }\r\n        if (ch === startSign && !isEscape) {\r\n            signCount += 1\r\n            intervalText += ch\r\n            continue\r\n        }\r\n        if (ch === endSign && !isEscape) {\r\n            if (signCount > 0) {\r\n                signCount -= 1\r\n                intervalText += ch\r\n                continue\r\n            }\r\n            break\r\n        }\r\n        intervalText += ch\r\n        isEscape = false\r\n    }\r\n\r\n    return intervalText\r\n}\r\n","import el from \"../dom/el.js\"\r\nimport countWord from \"../../../common/countWord.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\nimport resolvePathname from \"../../libs/resolve-pathname/index.js\"\r\n\r\n// identifier character to HTML tag\r\nconst KeyToken_TagName_map = new Map([\r\n    [\"#\", \"strong\"],\r\n    [\"`\", \"code\"],\r\n    [\"_\", \"u\"],\r\n    [\"/\", \"i\"],\r\n    [\"-\", \"del\"],\r\n    [\":\", \"span.dim\"],\r\n    [\",\", \"sub\"],\r\n    [\"'\", \"sup\"],\r\n    [\"$\", \"span.math\"],\r\n])\r\n\r\nconst PairedParenMap = new Map([\r\n    [\"[\", \"]\"],\r\n    [\"{\", \"}\"],\r\n    [\"<\", \">\"],\r\n])\r\n\r\n// --- --- --- --- --- ---\r\n\r\nlet katexRenderer = null\r\nif (typeof window === \"undefined\") {\r\n    const renderModule = await import(\"../../../builder/utils/renderer/index.js\")\r\n    katexRenderer = content => renderModule.render(content, \"katex\")\r\n}\r\n\r\nclass TextToken {\r\n    constructor(content) {\r\n        this.content = content\r\n    }\r\n    count  = () => countWord(this.content)\r\n    toHTML = () => el(\"text\", this.content)\r\n}\r\nclass KeyToken {\r\n    constructor(tagSign, content) {\r\n        const tag = KeyToken_TagName_map.get(tagSign)\r\n        if (tag.includes(\".\")) {\r\n            const [realTagName, className] = tag.split(\".\")\r\n            this.tagName = realTagName\r\n            this.className = className\r\n        } else {\r\n            this.tagName = tag\r\n        }\r\n        this.content = content\r\n\r\n        if (this.className === \"math\" && typeof window === \"object\") {\r\n            // set this global variable to import\r\n            // the math formula renderer module\r\n            globalThis.__ContainsFormula__ = true\r\n        }\r\n    }\r\n\r\n    count = () => countEntry(this.content)\r\n    toHTML() {\r\n        if (this.className === \"math\" && typeof window === \"undefined\") {\r\n            // for katex rendering in node.js\r\n            const filename = katexRenderer(this.content)\r\n            const formulaImage = el(\"img\", \"\", {\r\n                src: \"./\" + filename\r\n            })\r\n            const container = el(\"span\", formulaImage, {\r\n                \"class\": \"math\"\r\n            })\r\n            return container\r\n        }\r\n        const elOption = this.className === undefined ? null : {\"class\": this.className}\r\n        const thisEl = el(this.tagName, parseEntry(this.content), elOption)\r\n        return thisEl\r\n    }\r\n}\r\n\r\nclass LinkToken {\r\n    constructor(content, address) {\r\n        this.content = content\r\n        this.address = address\r\n    }\r\n\r\n    count = () => 0\r\n    toHTML() {\r\n        const displayContent = parseEntry(this.content)\r\n        try {\r\n            new URL(this.address)\r\n            return el(\"a\", displayContent, {\r\n                href: this.address,\r\n                target: \"_blank\"\r\n            })\r\n        } catch { /* if not a full URL */ }\r\n\r\n        /* from here: https://stackoverflow.com/a/201378/28207463 */\r\n        const emailPattern = /(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/\r\n        if (emailPattern.test(this.address)) {\r\n            return el(\"a\", displayContent, {\r\n                href: \"mailto:\" + this.address,\r\n                target: \"_blank\"\r\n            })\r\n        }\r\n\r\n        if (this.address.startsWith(\"//\")) {\r\n            // relative link for some extra HTML files\r\n            return el(\"a\", displayContent, {\r\n                href: this.address.slice(2),\r\n            })\r\n        } else if (this.address.startsWith(\"/\")) {\r\n            // static resources or links relative to `static` directory\r\n            const actualAddress = \"static\" + this.address\r\n            return el(\"a\", displayContent, {\r\n                href: \"#\" + actualAddress\r\n            })\r\n        }\r\n\r\n        let base\r\n        if (\"location\" in globalThis) {\r\n            base = location.hash\r\n        } else {\r\n            base = globalThis.__ResourcePath__\r\n        }\r\n        const actualAddress = resolvePathname(this.address, base)\r\n        return el(\"a\", displayContent, {\r\n            href: actualAddress\r\n        })\r\n    }\r\n}\r\nclass PhoneticToken {\r\n    constructor(content, notation) {\r\n        this.content  = content\r\n        this.notation = notation\r\n    }\r\n\r\n    count = () => countEntry(this.content)\r\n    toHTML() {\r\n        const ignoredLeftParenthesis = el(\"rp\", \"(\")\r\n        const ignoredRightParenthesis = el(\"rp\", \")\")\r\n        const notationEl = el(\"rt\", this.notation)\r\n\r\n        const content = parseEntry(this.content).concat([\r\n            ignoredLeftParenthesis,\r\n            notationEl,\r\n            ignoredRightParenthesis,\r\n        ])\r\n        return el(\"ruby\", content, {\r\n            \"data-notation\": this.notation\r\n        })\r\n    }\r\n}\r\nclass DetailToken {\r\n    constructor(content, detail) {\r\n        this.content = content\r\n        this.detail  = detail\r\n    }\r\n\r\n    count = () =>\r\n        countEntry(this.content) +\r\n        countEntry(this.detail)\r\n    toHTML() {\r\n        const detailEl = el(\"div\", parseEntry(this.detail), {\r\n            \"class\": \"detail-content\",\r\n        })\r\n        return el(\"span\", [this.content, detailEl], {\r\n            \"class\": \"detail\",\r\n            \"data-collapse\": true,\r\n            onclick(e) {\r\n                e.stopPropagation()\r\n                e.target.toggleAttribute(\"data-collapse\")\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nfunction parser(source) {\r\n    function getFirstChar() {\r\n        const ch = source.charAt(0)\r\n        source = source.substring(1)\r\n        return ch\r\n    }\r\n    function getSpecialTokenClass(tokenSign) {\r\n        let targetTokenType\r\n        if (tokenSign === \"[\") {\r\n            targetTokenType = LinkToken\r\n        } else if (tokenSign === \"{\") {\r\n            targetTokenType = PhoneticToken\r\n        } else if (tokenSign === \"<\") {\r\n            targetTokenType = DetailToken\r\n        } else { /* unreachable */ }\r\n        return targetTokenType\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const tokens = []\r\n    let textTerm = \"\" // text\r\n    let keyTerm  = \"\" // inline style content\r\n    let keyStart = \"\"\r\n    let isEscape = false\r\n    let isInKey  = false\r\n\r\n    while (source.length) {\r\n        const ch = getFirstChar()\r\n\r\n        // key rules resolve\r\n        if (KeyToken_TagName_map.has(ch)) {\r\n            if (isEscape) {\r\n                if (isInKey) {\r\n                    keyTerm += \"\\\\\" + ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                isEscape = false\r\n                continue\r\n            }\r\n\r\n            if (isInKey && ch != keyStart) {\r\n                keyTerm += ch\r\n                continue\r\n            }\r\n\r\n            const nextCh = getFirstChar()\r\n            if (nextCh != ch) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                source = nextCh + source\r\n                continue\r\n            }\r\n\r\n            if (isInKey) {\r\n                tokens.push(new KeyToken(ch, keyTerm))\r\n                keyTerm  = \"\"\r\n                keyStart = \"\"\r\n            } else {\r\n                tokens.push(new TextToken(textTerm))\r\n                textTerm = \"\"\r\n                keyStart = ch\r\n            }\r\n            isInKey = !isInKey\r\n            continue\r\n        }\r\n\r\n        // special inline rules resolve\r\n        if ([\"[\", \"{\", \"<\"].includes(ch) && !isInKey && !isEscape) {\r\n            const specialTokenSign = ch\r\n            const pairedTokenSign = PairedParenMap.get(specialTokenSign)\r\n\r\n            tokens.push(new TextToken(textTerm))\r\n            textTerm = \"\"\r\n\r\n            let removedContent = specialTokenSign\r\n            // the actual displayed content for special inline elements\r\n            const displayContent = getInterval(source, specialTokenSign, pairedTokenSign, true)\r\n            if (displayContent != null) {\r\n                removedContent += source.slice(0, displayContent.length + 1)\r\n                source = source.substr(displayContent.length + 1)\r\n\r\n                const nextCh = getFirstChar()\r\n                removedContent += nextCh\r\n                if (nextCh === \"(\") {\r\n                    // the hidden displayed content for special inline elements\r\n                    const hiddenContent = getInterval(source, \"(\", \")\")\r\n                    if (hiddenContent != null) {\r\n                        let targetTokenType = getSpecialTokenClass(specialTokenSign)\r\n                        source = source.substr(hiddenContent.length + 1)\r\n                        tokens.push(new targetTokenType(displayContent, hiddenContent))\r\n                        continue\r\n                    }\r\n                }\r\n            }\r\n            textTerm += removedContent\r\n            continue\r\n        }\r\n\r\n        // --- --- --- --- --- ---\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n\r\n        let text\r\n        if (isEscape) {\r\n            text = \"\\\\\" + ch\r\n            isEscape = false\r\n        } else {\r\n            text = ch\r\n        }\r\n\r\n        if (isInKey) {\r\n            keyTerm += text\r\n        } else {\r\n            textTerm += text\r\n        }\r\n    }\r\n\r\n    if (keyTerm.length) {\r\n        tokens.push(new KeyToken(keyStart, keyTerm))\r\n    }\r\n    if (textTerm.length) {\r\n        tokens.push(new TextToken(textTerm))\r\n    }\r\n    return tokens\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nexport function countEntry(source) {\r\n    const tokens = parser(source)\r\n    const result = tokens.reduce((accumulator, current) =>\r\n        accumulator += current.count()\r\n    , 0)\r\n    return result\r\n}\r\n\r\nexport function getRawContent(source) {\r\n    const tokens = parser(source)\r\n    const resultContent = []\r\n\r\n    for (const token of tokens) {\r\n        if (token instanceof KeyToken && token.className === \"math\") {\r\n            continue\r\n        }\r\n        if (token instanceof LinkToken) {\r\n            continue\r\n        }\r\n        resultContent.push(token.content)\r\n    }\r\n\r\n    return resultContent.join(\"\")\r\n}\r\n\r\nexport function parseEntry(source) {\r\n    const htmlEntityReplace = source => source\r\n        .replaceAll(\"<\", \"&lt;\")\r\n        .replaceAll(\">\", \"&gt;\")\r\n\r\n    const tokens = parser(source)\r\n    const resultHTML = tokens\r\n        .filter(token =>\r\n            // remove empty TextToken\r\n            !(token instanceof TextToken && !token.content.length))\r\n        .map(token => token.toHTML())\r\n    if (typeof window !== \"object\" && source === resultHTML[0]) {\r\n        // for server rendering\r\n        return htmlEntityReplace(source)\r\n    }\r\n    return resultHTML\r\n}\r\n\r\n// test cases\r\n// console.log(parser(\"``\\\\```\"))\r\n// console.log(parseEntry(\"##bo//itelic//ld##\"))\r\n// console.log(parseEntry(\"##bo[link text](http://www.com)ld##\"))\r\n// console.log(parseEntry(\"::dim[link text](http://www.com)med::\"))\r\n// console.log(parseEntry(\"[http:\\\\/\\\\/www.com](http://www.com)\"))\r\n// console.log(parseEntry(\"//ita[link text](http:\\\\/\\\\/www.com)lic//\"))\r\n// console.log(parseEntry(\"``<test>``\"))\r\n// console.log(parseEntry(\"asd[asd\"))\r\n// console.log(parseEntry(\"asd[asd]asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd)\"))\r\n// console.log(parseEntry(\"asd[##link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link](asd)##\"))\r\n// console.log(parseEntry(\"::dimmed::\"))\r\n// console.log(parseEntry(\"$$f_c = \\\\frac{1}{abc}$$\"))\r\n","import { countEntry, parseEntry } from \"./inline.js\"\r\nimport el from \"../dom/el.js\"\r\nimport languageSelector from \"../languageSelector.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\nimport resolvePathname from \"../../libs/resolve-pathname/index.js\"\r\n\r\nexport class Headline {\r\n    constructor(content) {\r\n        // \"### test\" -> \"###\"\r\n        const splited = content.split(\" \")\r\n        const numberSignStr = splited[0]\r\n        const numberSignCount = Math.min(numberSignStr.length, 6)\r\n\r\n        const rawContent = splited.slice(1).join(\" \")\r\n        this.tagName = \"h\" + numberSignCount\r\n        this.content = rawContent\r\n    }\r\n    toHTML() {\r\n        const options = this.id === undefined\r\n            ? null\r\n            : { id: this.id }\r\n        const parsedContent = parseEntry(this.content)\r\n        return el(this.tagName, parsedContent, options)\r\n    }\r\n\r\n    static pattern = source => /^(#+ )/.test(source)\r\n}\r\n\r\nexport class Para {\r\n    tagName = \"p\"\r\n\r\n    constructor(content) {\r\n        this.content = content.trimStart()\r\n    }\r\n    toHTML() {\r\n        const inline = parseEntry(this.content)\r\n        return el(this.tagName, inline)\r\n    }\r\n}\r\n\r\nexport class EmptyLine {\r\n    tagName = \"br\"\r\n\r\n    toHTML() {\r\n        return el(this.tagName)\r\n    }\r\n    static pattern = source => [\"\\\\\\\\\", \"  \"].includes(source)\r\n}\r\n\r\nexport class Quote {\r\n    children = []\r\n    title    = \"\"\r\n    type     = Quote.NormalTypeEnum\r\n\r\n    constructor(children) {\r\n        const isAlertQuote = children[0] instanceof Para\r\n            && Quote.alertPattern(children[0].content)\r\n\r\n        if (!isAlertQuote) {\r\n            this.children = children\r\n            return\r\n        }\r\n\r\n        let defaultTitle\r\n        const titleLine  = children[0].content\r\n        const targetType = getInterval(titleLine.slice(1), \"[\", \"]\")\r\n        switch (targetType.toLowerCase()) {\r\n            case \"note\": case \"笔记\":\r\n                this.type = Quote.NoteTypeEnum\r\n                defaultTitle = languageSelector(\"笔记\", \"Note\")\r\n                break\r\n            case \"tip\": case \"提示\":\r\n                this.type = Quote.TipTypeEnum\r\n                defaultTitle = languageSelector(\"提示\", \"Tip\")\r\n                break\r\n            case \"important\": case \"重要\":\r\n                this.type = Quote.ImportantTypeEnum\r\n                defaultTitle = languageSelector(\"重要\", \"Important\")\r\n                break\r\n            case \"warning\": case \"注意\":\r\n                this.type = Quote.warningTypeEnum\r\n                defaultTitle = languageSelector(\"注意\", \"Warning\")\r\n                break\r\n            case \"caution\": case \"警告\":\r\n                this.type = Quote.CautionTypeEnum\r\n                defaultTitle = languageSelector(\"警告\", \"Caution\")\r\n                break\r\n        }\r\n        const titleString = titleLine\r\n            .slice(targetType.length + 2)\r\n            .trimStart()\r\n        this.title = titleString || defaultTitle\r\n        this.children = children.slice(1)\r\n    }\r\n    toHTML() {\r\n        if (this.type === Quote.NormalTypeEnum) {\r\n            const innerNodes = this.children\r\n                .map(node => node.toHTML())\r\n            return el(\"blockquote\", innerNodes)\r\n        }\r\n        const headline = el(\"p\", this.title, {\r\n            \"class\": \"alert-title\"\r\n        })\r\n        const innerNodes = this.children\r\n            .map(node => node.toHTML())\r\n        return el(\"blockquote\", [headline].concat(innerNodes), {\r\n            \"class\": [\"alert\", this.type.description]\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        (source === \">\") || source.startsWith(\"> \")\r\n    static alertPattern = source =>\r\n        /^\\[(.+?)\\](?:(\\s+)(.*))?$/.test(source)\r\n\r\n    static NormalTypeEnum    = Symbol(\"normal\")\r\n    static NoteTypeEnum      = Symbol(\"note\")\r\n    static TipTypeEnum       = Symbol(\"tip\")\r\n    static ImportantTypeEnum = Symbol(\"important\")\r\n    static warningTypeEnum   = Symbol(\"warning\")\r\n    static CautionTypeEnum   = Symbol(\"caution\")\r\n}\r\n\r\nexport class Divider {\r\n    toHTML = () => el(\"hr\")\r\n    static pattern = source =>\r\n        source.match(/(-\\s*-\\s*-)|(\\*\\s*\\*\\s*\\*)/) && !source.match(/[a-zA-Z0-9]/)\r\n}\r\n\r\nexport class List {\r\n    children = []\r\n\r\n    constructor(content) {\r\n        this.isOrdered = List.orderedPattern(content)\r\n        this.tagName   = (this.isOrdered) ? \"ol\" : \"ul\"\r\n        this.children  = [List.getContent(content, this.isOrdered)]\r\n    }\r\n\r\n    toHTML() {\r\n        const childrenHTML = this.children.map(child => {\r\n            if (typeof child === \"string\") {\r\n                const inline = parseEntry(child)\r\n                return el(\"li\", inline)\r\n            } else {\r\n                return child.toHTML()\r\n            }\r\n        })\r\n        return el(this.tagName, childrenHTML)\r\n    }\r\n\r\n    static orderedPattern   = source => /^([\\s\\t]*[0-9]+\\. )/.test(source)\r\n    static unorderedPattern = source => /^([\\s\\t]*[+-] )/.test(source)\r\n    static taskListPattern  = source => /^[\\s\\t]*- \\[( |x|\\*)\\] /.test(source)\r\n    static isListPattern    = source => List.orderedPattern(source) || List.unorderedPattern(source)\r\n\r\n    static getContent(line, isOrdered) {\r\n        if (isOrdered) {\r\n            // \"1. ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[0-9]+. )).+$/g)[0]\r\n        } else if (this.taskListPattern(line)) {\r\n            // \"- [ ] ...\" | \"- [x] ...\" => \"...\"\r\n            const trimedLine = line.trimStart()\r\n            return new TaskListItem(trimedLine.slice(6), trimedLine.slice(0, 6))\r\n        } else if (this.unorderedPattern(line)) {\r\n            // \"- ...\" | \"+ ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[+-]+ )).+$/g)[0]\r\n        } else {\r\n            throw new Error(\"Unexpected list item: \" + line)\r\n        }\r\n    }\r\n}\r\n\r\nclass TaskListItem {\r\n    constructor(content, prefix) {\r\n        this.content = content\r\n        this.isChecked = TaskListItem.checkedSignList.includes(prefix[3])\r\n    }\r\n    count() {\r\n        return countEntry(this.content)\r\n    }\r\n    toHTML() {\r\n        const inputEl = el(\"input\", \"\", {\r\n            type: \"checkbox\",\r\n            checked: this.isChecked,\r\n        })\r\n        const inline = parseEntry(this.content)\r\n        const listItemEl = el(\"li\", [inputEl, ...inline], {\r\n            \"class\": \"task-list-item\"\r\n        })\r\n        return listItemEl\r\n    }\r\n    static checkedSignList = [\"*\", \"x\"]\r\n}\r\n\r\nexport class QABlock {\r\n    elements = [] // list for `Question` and `Answer`\r\n    push(element) {\r\n        this.elements.push(element)\r\n    }\r\n    toHTML() {\r\n        const container = el(\"div\", this.elements.map(item => item.toHTML()), {\r\n            \"class\": \"qa-block\"\r\n        })\r\n        return container\r\n    }\r\n}\r\n\r\nexport class Question {\r\n    constructor(content) {\r\n        this.content = content.substr(3)\r\n    }\r\n    toHTML() {\r\n        const container = el(\"div\", parseEntry(this.content), {\r\n            \"class\": \"question\"\r\n        })\r\n        return container\r\n    }\r\n    static pattern = source => source.startsWith(\"Q: \")\r\n}\r\nexport class Answer {\r\n    constructor(content) {\r\n        this.content = content.substr(3)\r\n    }\r\n    toHTML() {\r\n        const container = el(\"div\", parseEntry(this.content), {\r\n            \"class\": \"answer\"\r\n        })\r\n        return container\r\n    }\r\n    static pattern = source => source.startsWith(\"A: \")\r\n}\r\n\r\nexport class Table {\r\n    headerCells = [\"\"]   // [string]\r\n    bodyRows    = [[\"\"]] // [[string]]\r\n\r\n    constructor(headerCells, bodyRows) {\r\n        this.headerCells = headerCells\r\n        this.bodyRows    = bodyRows\r\n    }\r\n\r\n    #tableHeaderCell = content => el(\"th\", content)\r\n    #tableBodyCell   = content => el(\"td\", parseEntry(content))\r\n    #tableHeaderRow  = row => el(\"tr\", row.map(this.#tableHeaderCell))\r\n    #tableBodyRow    = row => el(\"tr\", row.map(this.#tableBodyCell))\r\n\r\n    toHTML() {\r\n        const tableHeader = el(\r\n            \"thead\",\r\n            this.#tableHeaderRow(this.headerCells)\r\n        )\r\n        const tableBody = el(\r\n            \"tbody\",\r\n            this.bodyRows\r\n                .map(this.#tableBodyRow)\r\n        )\r\n        return el(\"div\", el(\"table\", [tableHeader, tableBody]), {\r\n            \"class\": \"table\"\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"| \")\r\n}\r\n\r\n// --- --- --- --- -\r\n// media nodes start\r\n// --- --- --- --- -\r\n\r\nclass MediaNode {\r\n    source = \"\"\r\n    description = \"\"    \r\n    constructor(mdText) {\r\n        mdText = mdText.substr(2)\r\n        this.description = getInterval(mdText, \"[\", \"]\")\r\n        mdText = mdText.substr(this.description.length + 2)\r\n        this.source = getInterval(mdText, \"(\", \")\")\r\n    }\r\n\r\n    static containerGenerator(content, type) {\r\n        return el(\"div\", content, {\r\n            \"class\": [\"media-container\", type ?? \"\"]\r\n        })\r\n    }\r\n\r\n    static patternGenerator(identifierSign) {\r\n        return (source) =>\r\n            source.startsWith(identifierSign + \"[\") && source.endsWith(\")\")\r\n    }\r\n\r\n    static replaceContentGenerator(href, description) {\r\n        const downloadEl = el(\"a\", languageSelector(\"从这里下载！\", \"Download Here!\"), { href })\r\n        const replaceContent = `${description}<br>${downloadEl}`\r\n        return replaceContent\r\n    }\r\n\r\n    static srcUrlResolver(rawUrl) {\r\n        try {\r\n            new URL(rawUrl)\r\n            return rawUrl\r\n        } catch { /* if not a full URL */ }\r\n\r\n        if (rawUrl.startsWith(\"//\")) {\r\n            // relative link for some extra HTML files\r\n            return rawUrl.slice(2)\r\n        } else if (rawUrl.startsWith(\"/\")) {\r\n            // static resources or links relative to `static` directory\r\n            return \"static\" + rawUrl\r\n        }\r\n\r\n        const base = location.hash.slice(1)\r\n        return resolvePathname(rawUrl, base)\r\n    }\r\n}\r\n\r\nexport class Image extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"!\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const isDrawioDiagram = this.source.endsWith(\"drawio.svg\")\r\n        const imageEl = el(\"img\", \"\", {\r\n            src: actualUrl,\r\n            alt: this.description,\r\n            loading: \"lazy\",\r\n            tabindex: 0,\r\n            \"class\": isDrawioDiagram ? \"drawio\" : undefined\r\n        })\r\n        imageEl.onclick = e =>\r\n            window.open(e.target.src)\r\n        imageEl.onerror = e => {\r\n            const target = e.target\r\n            target.onclick = null\r\n            target.title = this.description\r\n            target.classList.add(\"load-error\")\r\n            target.parentNode.classList.remove(\"image\")\r\n        }\r\n        return MediaNode.containerGenerator(imageEl, \"image\")\r\n    }\r\n}\r\n\r\nexport class Audio extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\":\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const audioEl = el(\"audio\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: true,\r\n        })\r\n        return MediaNode.containerGenerator(audioEl)\r\n    }\r\n}\r\n\r\nexport class Video extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"?\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const videoEl = el(\"video\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: \"true\",\r\n        })\r\n        return MediaNode.containerGenerator(videoEl)\r\n    }\r\n}\r\n\r\nexport const isIframePattern = (source) =>\r\n    MediaNode.patternGenerator(\"@\")(source)\r\n    || source.startsWith(\"@@@\")\r\n\r\nexport class Iframe extends MediaNode {\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            src: actualUrl,\r\n            title: this.description,\r\n            sandbox: \"allow-same-origin allow-scripts\",\r\n            loading: \"lazy\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl, \"iframe\")\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// media nodes end\r\n// --- --- --- ---\r\n\r\n// --- --- --- --- -\r\n// block nodes start\r\n// --- --- --- --- -\r\n\r\nexport class CodeBlock {\r\n    constructor(content, lang) {\r\n        this.lang = lang\r\n        this.content = content\r\n    }\r\n    toHTML() {\r\n        const isPlaintext = [\"plaintext\", \"text\", \"\"].includes(this.lang)\r\n        if (!isPlaintext) {\r\n            globalThis.__LanguageList__.add(this.lang)\r\n        }\r\n\r\n        let langName, langClass\r\n        if (isPlaintext) {\r\n            langClass = \"nohighlight\"\r\n            langName  = \"PLAINTEXT\"\r\n        } else {\r\n            langClass = `language-${this.lang}`\r\n            langName  = this.lang.toUpperCase()\r\n        }\r\n\r\n        const codeEl = el(\"code\", this.content, {\r\n            \"class\": langClass,\r\n            tabindex: 0,\r\n        })\r\n        return el(\"pre\", codeEl, {\r\n            \"class\": \"code-block\",\r\n            \"data-language\": langName,\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"```\")\r\n}\r\n\r\nexport class DetailsBlock {\r\n    summary = \"\"\r\n    content = \"\"\r\n\r\n    constructor(content, summary) {   \r\n        this.summary = summary\r\n        this.content = content\r\n    }\r\n    toHTML() {\r\n        const summaryEl = el(\"summary\", parseEntry(this.summary))\r\n        const detailsEl = el(\"details\", summaryEl)\r\n\r\n        const innerNodes = this.content\r\n            .map(node => node.toHTML())\r\n        const childrenEl = el(\"div\", el(\"div\", innerNodes, {\r\n            \"class\": \"details-children\"\r\n        }), {\r\n            \"class\": \"details-children-container\"\r\n        })\r\n        return el(\"div\", [detailsEl, childrenEl], {\r\n            \"class\": \"details\"\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\">>>\")\r\n}\r\n\r\nexport class FormulaBlock {\r\n    content = \"\"\r\n    description = \"\"\r\n\r\n    constructor(content, description) {\r\n        this.content = content\r\n        this.description = description\r\n    }\r\n    toHTML() {\r\n        globalThis.__ContainsFormula__ = true\r\n        return el(\"div\", this.content, {\r\n            \"class\": \"math\",\r\n            title: this.description,\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\"$$$\")\r\n}\r\n\r\nexport class IframeBlock {\r\n    // injected html codes, used to auto darkmode\r\n    // and send height message\r\n    static #injectedCodes = id => `\\\r\n<style>\r\nbody{transition: .3s .15s}\r\nbody.light{color:#333;background:#fff}\r\nbody.dark{color:#f7f7f7;background:#252525}</style>\r\n<script>\r\nconst rootEl = document.documentElement\r\nfunction postHeight() {\r\n    const parent = window.parent\r\n    const height = parseFloat(getComputedStyle(rootEl).height)\r\n    parent.postMessage({\r\n        height,\r\n        id: \"${id}\"\r\n    }, \"*\")\r\n}\r\nwindow.addEventListener(\"load\", postHeight)\r\nwindow.addEventListener(\"message\", e => {\r\nconst { fontSize, theme } = e.data\r\nif (fontSize) {\r\n    rootEl.style.fontSize = fontSize\r\n    postHeight()\r\n}\r\nif (theme) {\r\n    document.body.classList = theme\r\n}\r\n})\r\n</script>`\r\n\r\n    constructor(content, description) {\r\n        globalThis.__IframeCounter__ += 1\r\n        this.id = \"iframe_\" + globalThis.__IframeCounter__\r\n        this.description = description\r\n        this.content = content + IframeBlock.#injectedCodes(this.id)\r\n    }\r\n\r\n    toHTML() {\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            id: this.id,\r\n            title: this.description,\r\n            srcdoc: this.content,\r\n            sandbox: \"allow-scripts\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl, \"iframe\")\r\n    }\r\n}\r\n\r\n// types of chart blocks\r\n\r\nclass EchartsChartType {\r\n    constructor(content) {\r\n        const options = new Function(\r\n            \"let option;\"\r\n            + content\r\n            + \";return option\"\r\n        )()\r\n        this.chartOptions = options\r\n        globalThis.__ChartTypeList__.add(\"echarts\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"echarts-container\",\r\n        })\r\n        chartEl.__ChartOptions__ = this.chartOptions\r\n        return chartEl\r\n    }\r\n}\r\nclass FlowChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"flow-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"flowchart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass SequenceChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"sequence-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"sequencechart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass GanttChartType {\r\n    constructor(content) {\r\n        this.content = new Function(`const tasks = [${content}]; return tasks`)()\r\n        globalThis.__ChartTypeList__.add(\"gantt-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"ganttchart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass RailroadChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"railroad-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"railroad-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass QRCodeType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"qrcode\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"qrcode-container\"\r\n        })\r\n        chartEl.__QRCodeContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass UnknownChartType {\r\n    constructor(errMsg) {\r\n        this.content = errMsg\r\n    }\r\n    toHTML() {\r\n        return el(\"span\", this.content)\r\n    }\r\n}\r\n\r\nexport class ChartBlock {\r\n    static pattern = source =>\r\n        source.startsWith(\"!!!\")\r\n    \r\n    #type = null\r\n\r\n    constructor(content, type) {\r\n        switch (type) {\r\n            case \"\": case \"echarts\":\r\n                this.#type = new EchartsChartType(content)\r\n                break\r\n            case \"flow\":       case \"flowchart\":\r\n            case \"flow chart\": case \"flow-chart\":\r\n                this.#type = new FlowChartType(content)\r\n                break\r\n            case \"sequence\":      case \"sequencechart\":\r\n            case \"sequence char\": case \"sequence-chart\":\r\n                this.#type = new SequenceChartType(content)\r\n                break\r\n            case \"gantt\":       case \"ganttchart\":\r\n            case \"gantt chart\": case \"gantt-chart\":\r\n                this.#type = new GanttChartType(content)\r\n                break\r\n            case \"rail\": case \"railroad\": case \"railroadchart\":\r\n            case \"railroad chart\":        case \"railroad-chart\":\r\n                this.#type = new RailroadChartType(content)\r\n                break\r\n            case \"qrcode\": case \"qr-code\": case \"qr code\":\r\n                this.#type = new QRCodeType(content)\r\n                break\r\n            default:\r\n                const errMsg = \"Unknown chart type: \" + type\r\n                console.error(errMsg)\r\n                this.#type = new UnknownChartType(errMsg)\r\n        }\r\n    }\r\n    toHTML() {\r\n        const chartEl = this.#type.toHTML()\r\n        return MediaNode.containerGenerator(chartEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// block nodes end\r\n// --- --- --- ---\r\n","export default function(line) {\r\n    let indentCount = 0\r\n    let spaceCount = 0\r\n\r\n    for (const ch of line) {\r\n        if (ch.match(/[^\\s\\t]/)) {\r\n            break\r\n        }\r\n\r\n        if (ch === \"\\t\") {\r\n            indentCount += 1\r\n            continue\r\n        }\r\n        if (ch === \" \") {\r\n            spaceCount += 1\r\n        }\r\n        if (spaceCount === 2) {\r\n            spaceCount = 0\r\n            indentCount += 1\r\n        }\r\n    }\r\n    return indentCount\r\n}\r\n","import { List } from \"../node.js\"\r\nimport getIndent from \"../utils/getIndent.js\"\r\n\r\nexport default function listResolver(currentLine, lines) {\r\n    const currentIndent = getIndent(currentLine)\r\n    const currentNode = new List(currentLine)\r\n\r\n    while (lines.length && List.isListPattern(lines[0])) {\r\n        const nextLine = lines.shift()\r\n        const nextIndent = getIndent(nextLine)\r\n        const isNextOrdered = List.orderedPattern(nextLine)\r\n\r\n        if (nextIndent > currentIndent) {\r\n            currentNode.children.push(listResolver(nextLine, lines))\r\n        } else if (nextIndent === currentIndent && isNextOrdered === currentNode.isOrdered) {\r\n            currentNode.children.push(List.getContent(nextLine, isNextOrdered))\r\n        } else {\r\n            lines.unshift(nextLine)\r\n            break\r\n        }\r\n    }\r\n    return currentNode\r\n}","import mdResolver from \"../index.js\"\r\nimport { Quote } from \"../node.js\"\r\n\r\nexport default function(firstLine, lines) {\r\n    let quotedContent = firstLine.slice(2) + \"\\n\"\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Quote.pattern(l)) {\r\n            quotedContent += l.slice(2) + \"\\n\"\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n    const children = mdResolver(quotedContent)\r\n    const node = new Quote(children)\r\n    return node\r\n}\r\n","import { Table } from \"../node.js\"\r\n\r\n// input: \"| content | content |\"\"\r\n// output: [\"content\",\"content\"]\r\nfunction tableLineConverter(tableLine) {\r\n    const splited = tableLine.split(\"|\")\r\n    const result = splited\r\n        .filter(item => item.length > 0)\r\n        .map(item => item.trim())\r\n    return result\r\n}\r\n\r\nexport default function(firstLine, lines) {\r\n    const headerText = firstLine\r\n    const contentLines = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Table.pattern(l)) {\r\n            contentLines.push(l)\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n\r\n    const headerCells = tableLineConverter(headerText)\r\n    const contentRows = contentLines.map(tableLineConverter)\r\n    const tableNode = new Table(headerCells, contentRows)\r\n    return tableNode\r\n}\r\n","import { Answer, QABlock, Question } from \"../node.js\"\r\n\r\nexport default function QAResolver(firstLine, lines) {\r\n    const block = new QABlock()\r\n    lines.unshift(firstLine)\r\n\r\n    while (lines.length) {\r\n        const line = lines[0]\r\n        const isQuestion = Question.pattern(line)\r\n        const isAnswer = Answer.pattern(line)\r\n\r\n        if (isQuestion) {\r\n            block.push(new Question(line))\r\n        } else\r\n        if (isAnswer) {\r\n            block.push(new Answer(line))\r\n        } else {\r\n            // !isQuestion && !isAnswer\r\n            break\r\n        }\r\n        lines.shift()\r\n    }\r\n    return block\r\n}\r\n","import mdResolver from \"../index.js\"\r\nimport { ChartBlock, CodeBlock, DetailsBlock, FormulaBlock, Iframe, IframeBlock } from \"../node.js\"\r\n\r\nexport function blockResolverGenerator(endSign, targetClass) {\r\n    return function(firstLine, lines) {\r\n        const description = firstLine.slice(3)\r\n\r\n        let content = \"\"\r\n        while (lines.length) {\r\n            const l = lines.shift()\r\n\r\n            if (l === endSign) {\r\n                break\r\n            }\r\n\r\n            content += l + \"\\n\"\r\n        }\r\n        return new targetClass(content, description)\r\n    }\r\n}\r\n\r\nexport const codeResolver    = blockResolverGenerator(\"```\", CodeBlock)\r\nexport const chartResolver   = blockResolverGenerator(\"!!!\", ChartBlock)\r\nexport const formulaResolver = blockResolverGenerator(\"$$$\", FormulaBlock)\r\nexport function detailsResolver(firstLine, lines) {\r\n    const resolver = blockResolverGenerator(\">>>\", DetailsBlock)\r\n    const node = resolver(firstLine, lines)\r\n    node.content = mdResolver(node.content)\r\n    return node\r\n}\r\nexport function iframeResolver(firstLine, lines) {\r\n    const resolver = blockResolverGenerator(\"@@@\", IframeBlock)\r\n\r\n    if (!firstLine.startsWith(\"@@@\")) {\r\n        // link to out resource\r\n        return new Iframe(firstLine)\r\n    }\r\n    return resolver(firstLine, lines)\r\n}\r\n","import {\r\n    Headline, EmptyLine,\r\n    Quote, Divider,\r\n    List, Para, Table,\r\n    Image, Audio, Video,\r\n    FormulaBlock, CodeBlock,\r\n    isIframePattern,\r\n    DetailsBlock,\r\n    ChartBlock,\r\n    Question,\r\n    Answer,\r\n} from \"./node.js\"\r\nimport {\r\n    listResolver, quoteResolver, tableResolver,\r\n    codeResolver, formulaResolver, chartResolver,\r\n    iframeResolver, detailsResolver,\r\n    QAResolver,\r\n} from \"./resolvers/index.js\"\r\nimport getLines from \"./utils/getLines.js\"\r\n\r\nexport default function mdResolver(source) {\r\n    const lines = getLines(source)\r\n    const nodes = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (!l.length) {\r\n            // skip empty line\r\n            continue\r\n        }\r\n\r\n        if (Headline.pattern(l)) {\r\n            nodes.push(new Headline(l))\r\n        } else\r\n        if (EmptyLine.pattern(l)) {\r\n            nodes.push(new EmptyLine)\r\n        } else\r\n        if (Divider.pattern(l)) {\r\n            nodes.push(new Divider)\r\n        } else\r\n        if (Quote.pattern(l)) {\r\n            nodes.push(quoteResolver(l, lines))\r\n        } else\r\n        if (List.isListPattern(l)) {\r\n            nodes.push(listResolver(l, lines))\r\n        } else\r\n        if (Question.pattern(l) || Answer.pattern(l)) {\r\n            nodes.push(QAResolver(l, lines))\r\n        } else\r\n        if (Table.pattern(l)) {\r\n            nodes.push(tableResolver(l, lines))\r\n        } else\r\n        if (Image.pattern(l)) {\r\n            nodes.push(new Image(l))\r\n        } else\r\n        if (Audio.pattern(l)) {\r\n            nodes.push(new Audio(l))\r\n        } else\r\n        if (Video.pattern(l)) {\r\n            nodes.push(new Video(l))\r\n        } else\r\n        if (DetailsBlock.pattern(l)) {\r\n            nodes.push(detailsResolver(l, lines))\r\n        } else\r\n        if (FormulaBlock.pattern(l)) {\r\n            nodes.push(formulaResolver(l, lines))\r\n        } else\r\n        if (CodeBlock.pattern(l)) {\r\n            nodes.push(codeResolver(l, lines))\r\n        } else\r\n        if (ChartBlock.pattern(l)) {\r\n            nodes.push(chartResolver(l, lines))\r\n        } else\r\n        if (isIframePattern(l)) {\r\n            nodes.push(iframeResolver(l, lines))\r\n        } else {\r\n            nodes.push(new Para(l))\r\n        }\r\n    }\r\n    return nodes\r\n}","export default function(source) {\r\n    if (source.indexOf(\"\\r\") != -1) {\r\n        return source.split(\"\\r\\n\")\r\n    } else {\r\n        return source.split(\"\\n\")\r\n    }\r\n}","export default function(el) {\r\n    return function(e) {\r\n        // when Enter key or Space key\r\n        if (e.key === \"Enter\" || e.key === \" \") {\r\n            el.click()\r\n        }\r\n    }\r\n}\r\n","import debounce from \"../../../common/debounce.js\"\r\n\r\nexport const currentScrollTop = () =>\r\n    window.scrollY || document.documentElement.scrollTop\r\nexport const maxScrollTop = () =>\r\n    document.documentElement.scrollHeight - document.documentElement.clientHeight\r\n\r\n/**\r\n * @description scroll to specific position\r\n * @param {number} pos \r\n */\r\nexport function scrollToPos(pos) {\r\n    window.scroll({\r\n        top: pos,\r\n        behavior: \"smooth\",\r\n    })\r\n}\r\n\r\n/**\r\n * @description scroll to the position of specific element\r\n * @param {Element} el \r\n * @param {number} offset \r\n */\r\nexport function scrollToEl(el, offset) {\r\n    const scrollTargetPos = el.offsetTop\r\n    const scrollOffset = -offset\r\n    scrollToPos(scrollTargetPos + scrollOffset)\r\n}\r\n\r\n/** @description scroll to the document top */\r\nexport function scrollToTop() {\r\n    scrollToPos(0)\r\n}\r\n\r\n/**\r\n * @param {Function} scrollController \r\n * @param {() => boolean} predicate \r\n */\r\nexport function ensureScrollTo(scrollController, predicate) {\r\n    function scrollEnd() {\r\n        const isAtPageBottom = Math.abs(maxScrollTop() - currentScrollTop()) < 10\r\n        if (isAtPageBottom || predicate()) {\r\n            window.removeEventListener(\"scroll\", debounced)\r\n        } else {\r\n            scrollController()\r\n        }\r\n    }\r\n    const debounced = debounce(scrollEnd, 30)\r\n    window.addEventListener(\"scroll\", debounced)\r\n    scrollController()\r\n}\r\n","/** @import { OptionalComponentConfig } from \"../types/optionalComponentConfig.d.ts\" */\r\n/**\r\n * @param {OptionalComponentConfig | undefined} config \r\n * @returns {boolean} isEnabled\r\n */\r\nexport default function isEnabled(config) {\r\n    return (config != undefined) && config.enable\r\n}","import highlightRender from \"./importers/highlight.js\"\r\nimport katexRender from \"./importers/katex.js\"\r\nimport chartRender from \"./importers/charts/index.js\"\r\n\r\nimport { allIframeLoaded, setIframeTheme } from \"./iframeController.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport mdResolver from \"../utils/markdown/index.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport eventbus from \"../../common/eventbus/inst.js\"\r\nimport { config } from \"../utils/loadConfig.js\"\r\nimport { Headline } from \"../utils/markdown/node.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\nimport { currentScrollTop, ensureScrollTo, scrollToPos } from \"../utils/dom/scrollControl.js\"\r\nimport { parseEntry } from \"../utils/markdown/inline.js\"\r\nimport isEnabled from \"../../common/isEnabled.js\"\r\n\r\nconst emptyArticlePlaceHolder = languageSelector(\"空文章\", \"Empty Article\")\r\n\r\nfunction getHeadlines(structure) {\r\n    return structure\r\n        .filter(node => node instanceof Headline)\r\n        .map((node, index) => {\r\n            const id = node.id = \"headline-\" + index\r\n            const content = parseEntry(node.content)\r\n            return {\r\n                id, content,\r\n                level: node.tagName,\r\n            }\r\n        })\r\n}\r\n\r\nexport default function articleRender(articleEl, mdText) {\r\n    // language names to import for `highlight.js`\r\n    globalThis.__LanguageList__ = new Set()\r\n    // to deside which chart library to import\r\n    globalThis.__ChartTypeList__ = new Set()\r\n    // to deside whether to import `katex`\r\n    globalThis.__ContainsFormula__ = false\r\n    // used to dynamic generate iframe id\r\n    globalThis.__IframeCounter__ = 0\r\n\r\n    const structure = mdResolver(mdText)\r\n    if (isEnabled(config.catalog)) {\r\n        const headlineItems = getHeadlines(structure)\r\n        eventbus.emit(\"article-rendered\", headlineItems)\r\n    }\r\n\r\n    let resultNodes = structure.map(node => node.toHTML())\r\n    if (!resultNodes.length) {\r\n        resultNodes = [el(\"h1\", emptyArticlePlaceHolder)]\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const fragment = document.createDocumentFragment()\r\n    resultNodes.forEach(el => fragment.appendChild(el))\r\n    articleEl.innerHTML = \"\"\r\n    articleEl.appendChild(fragment)\r\n\r\n    // set iframes' theme after all loaded\r\n    allIframeLoaded().then(setIframeTheme)\r\n\r\n    articleEl.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    Promise.all([\r\n        highlightRender(globalThis.__LanguageList__),\r\n        katexRender(globalThis.__ContainsFormula__),\r\n        chartRender(globalThis.__ChartTypeList__),\r\n    ]).then(() => {\r\n        globalThis.__LanguageList__    = null\r\n        globalThis.__ContainsFormula__ = false\r\n        globalThis.__ChartTypeList__   = null\r\n\r\n        // scroll to the position last leaved\r\n        const lastLeavePage = sessionStorage.getItem(\"last-leave-page\")\r\n        const lastLeavePos  = sessionStorage.getItem(\"last-leave-position\") || 0\r\n        sessionStorage.removeItem(\"last-leave-page\")\r\n        sessionStorage.removeItem(\"last-leave-position\")\r\n\r\n        if (currentScrollTop() > 0) return // when is scrolled, skip position restoring\r\n        if (location.hash !== lastLeavePage) return\r\n        const targetScrollPos = Number.parseInt(String(lastLeavePos))\r\n        ensureScrollTo(\r\n            () => scrollToPos(targetScrollPos),\r\n            () => targetScrollPos - currentScrollTop() < 100\r\n        )\r\n    })\r\n}\r\n","export default function(timestamp) {\r\n    const date = new Date(timestamp)\r\n    const formatedDate = new Intl.DateTimeFormat().format(date)\r\n    return formatedDate\r\n}\r\n","import articleRender from \"./articleRenderer.js\"\r\nimport { PagingView } from \"../components/paging.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport { scrollToTop } from \"../utils/dom/scrollControl.js\"\r\nimport dateFormatter from \"../utils/dateFormatter.js\"\r\n\r\nexport function newestItemRenderer(item) {\r\n    const titleEl = el(\"span\", item.title, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    const dateEl  = el(\"code\", dateFormatter(item.createTime))\r\n    return el(\"li\", [titleEl, dateEl], {\r\n        \"class\": \"underline-through\",\r\n        \"data-jumpto\": item.link,\r\n        tabindex: 0,\r\n    })\r\n}\r\nexport function directoryItemRenderer(item) {\r\n    const titleEl = el(\"span\", item.name, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    const codeEl = el(\"code\", dateFormatter(item.modifyTime))\r\n    return el(\"li\", [titleEl, codeEl], {\r\n        \"class\": \"underline-through\",\r\n        \"data-relative\": item.name,\r\n        tabindex: 0,\r\n    })\r\n}\r\n\r\nconst mainEl           = document.querySelector(\"main\")\r\nconst articleEl        = document.querySelector(\"article\")\r\nconst articleList      = mainEl.querySelector(\"#article-list\")\r\nconst dirDescriptionEl = mainEl.querySelector(\"#directory-description\")\r\nconst updateTimeEl     = mainEl.querySelector(\"#update-time code\")\r\n/** @type {PagingView} */\r\nconst pagingComponent  = mainEl.querySelector(\"paging-view\")\r\n\r\nexport default function indexRender(index, itemResolver) {\r\n    const {current, total, updateTime} = index\r\n    pagingComponent.setPage(current, total)\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    // reset directory description\r\n    dirDescriptionEl.innerHTML = \"\"\r\n    if (\"dirDescription\" in index) {\r\n        articleRender(dirDescriptionEl, index.dirDescription)\r\n    }\r\n\r\n    updateTimeEl.textContent = updateTime ? dateFormatter(updateTime) : \"\"\r\n\r\n    // reset articleList content\r\n    const fragment = document.createDocumentFragment()\r\n    index.content\r\n        .map(itemResolver)\r\n        .forEach(el => fragment.appendChild(el))\r\n    articleList.innerHTML = \"\"\r\n    articleList.appendChild(fragment)\r\n\r\n    // set keyboard event\r\n    articleList.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    articleEl.innerHTML = \"\"\r\n    mainEl.classList.remove(\"hidden\")\r\n    scrollToTop()\r\n}\r\n","/**\r\n * @param {string} path \r\n * @param {\"script\" | \"style\" | \"image\" | \"font\" | \"fetch\"} as_\r\n */\r\nexport default function dynamicPrefetch(path, as_) {\r\n    return new Promise((resolve, reject) => {\r\n        const linkEl = document.createElement(\"link\")\r\n        linkEl.rel = \"prefetch\"\r\n        linkEl.href = path\r\n        linkEl.as = as_\r\n\r\n        if (as_ === 'font') {\r\n            linkEl.crossOrigin = \"anonymous\"\r\n        }\r\n        document.head.appendChild(linkEl)\r\n        linkEl.onload = resolve\r\n        linkEl.onerror = reject\r\n    })\r\n}\r\n","import pageController from \"../components/paging.js\"\r\nimport { fetchJSON, fetchMD } from \"./resourceFetcher.js\"\r\nimport articleRender from \"./articleRenderer.js\"\r\nimport indexRender, { newestItemRenderer, directoryItemRenderer } from \"./indexRenderer.js\"\r\nimport dynamicPrefetch from \"./importers/prefetch.js\"\r\nimport { scrollToTop } from \"../utils/dom/scrollControl.js\"\r\n\r\nconst mainEl = document.querySelector(\"main\")\r\nconst newestHeader = document.querySelector(\"#newest-header\")\r\nconst directoryHeader = document.querySelector(\"#directory-header\")\r\nconst articleEl = document.querySelector(\"article\")\r\n\r\nasync function prefetchResources(contents) {\r\n    const currentHash = location.hash.slice(1)\r\n    const tasks = []\r\n    for (const item of contents) {\r\n        if (tasks.length >= 40) {\r\n            break\r\n        }\r\n        if (!item.name.endsWith(\"/\")) {\r\n            continue\r\n        }\r\n        const targetIndexPath = getIndexPathFromHash(currentHash + item.name)\r\n        tasks.push(dynamicPrefetch(targetIndexPath, \"fetch\"))\r\n    }\r\n    await Promise.all(tasks)\r\n}\r\n\r\nfunction getIndexPathFromHash(hash=location.hash.slice(1)) {\r\n    const dirPath = \"./.index/\"\r\n    const path = hash\r\n        .split(\"/\")\r\n        .slice(0, -1) // remove the last `/`\r\n    const targetPath = dirPath\r\n        + path.join(\"+\") + \"_\"\r\n        + pageController.current()\r\n    return targetPath\r\n}\r\n\r\nexport async function hashChangeEvent(e) {\r\n    if (!location.hash) {\r\n        pathManager.homepage()\r\n        return\r\n    }\r\n    const hash = location.hash.slice(1)\r\n    mainEl.classList.add(\"disabled\")\r\n\r\n    if (pathManager.isIn.newestPage()) {\r\n        // open newest page\r\n        const newestIndex = await fetchJSON(getIndexPathFromHash())\r\n        if (!newestIndex) return\r\n        newestHeader.classList.remove(\"hidden\")\r\n        directoryHeader.classList.add(\"hidden\")\r\n        indexRender(newestIndex, newestItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.directory()) {\r\n        // open directory\r\n        const index = await fetchJSON(getIndexPathFromHash())\r\n        if (!index) return\r\n        newestHeader.classList.add(\"hidden\")\r\n        directoryHeader.classList.remove(\"hidden\")\r\n        prefetchResources(index.content)\r\n        indexRender(index, directoryItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.article()) {\r\n        // open article\r\n        articleEl.innerHTML = \"\"\r\n        const articleContent = await fetchMD(\"./\" + hash)\r\n        if (!articleContent) return\r\n        mainEl.classList.add(\"hidden\")\r\n        articleRender(articleEl, articleContent)\r\n    } else {\r\n        pathManager.homepage()\r\n    }\r\n\r\n    mainEl.setAttribute(\"data-is-root\", String(hash === \"static/\"))\r\n    mainEl.setAttribute(\"data-is-newest\", String(hash.startsWith(\"newest/\")))\r\n    mainEl.classList.remove(\"disabled\")\r\n\r\n    const getHash = url => new URL(url).hash\r\n    if (e instanceof HashChangeEvent\r\n        && pathManager.isIn.directory(getHash(e.oldURL))\r\n        && pathManager.isIn.article(getHash(e.newURL))) {\r\n        // when enters an article from directory\r\n        scrollToTop()\r\n    }\r\n}\r\n\r\nwindow.addEventListener(\"hashchange\", hashChangeEvent)\r\n\r\nconst homepagePath = \"static/\"\r\nconst newestPath = \"newest/\"\r\nconst pathManager = {\r\n    homepage() {\r\n        location.hash = homepagePath\r\n    },\r\n\r\n    open(name) {\r\n        location.hash += name\r\n    },\r\n    jumpTo(target) {\r\n        location.hash = target\r\n    },\r\n    parent() {\r\n        if (this.isIn.root() || this.isIn.newestPage()) {\r\n            return homepagePath\r\n        }\r\n        const splited = location.hash.slice(1).split(\"/\")\r\n        if (this.isIn.directory()) {\r\n            return splited.slice(0, -2).join(\"/\") + \"/\"\r\n        }\r\n        if (this.isIn.article()) {\r\n            return splited.slice(0, -1).join(\"/\") + \"/\"\r\n        }\r\n        throw new Error(\"Unexpected hash: \" + location.hash)\r\n    },\r\n    isIn: {\r\n        root() {\r\n            return location.hash === \"#\" + homepagePath\r\n        },\r\n        newestPage() {\r\n            return location.hash === \"#\" + newestPath\r\n        },\r\n        directory(test) {\r\n            const testTarget = test || location.hash\r\n            return testTarget.startsWith(\"#static\")\r\n                && testTarget.endsWith(\"/\")\r\n        },\r\n        article(test) {\r\n            const testTarget = test || location.hash\r\n            return testTarget.startsWith(\"#static\")\r\n                && testTarget.endsWith(\".md\")\r\n        }\r\n    }\r\n}\r\n\r\nexport default pathManager\r\n","import { hashChangeEvent } from \"../scripts/pathManager.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\n\r\nclass PageController {\r\n    #pageList = [1]\r\n\r\n    current = () => this.#pageList[this.length() - 1]\r\n    next    = () => this.#pageList[this.length() - 1] += 1\r\n    prev    = () => this.#pageList[this.length() - 1] -= 1\r\n    jumpTo  = targetPage => this.#pageList[this.length() - 1] = Number(targetPage)\r\n    length  = () => this.#pageList.length\r\n\r\n    back() {\r\n        // called when \"popstate\" event emited\r\n        this.#pageList.pop()\r\n        if (!this.#pageList.length) {\r\n            this.#pageList.push(1)\r\n        }\r\n    }\r\n    open() {\r\n        // called when enter directory\r\n        this.#pageList.push(1)\r\n    }\r\n}\r\nconst pageController = new PageController()\r\nexport default pageController\r\n\r\n// --- --- --- --- --- ---\r\n\r\nconst btn = content => el(\"button\",\r\n    el(\"span\", content, {\r\n        \"class\": \"underline-target\"\r\n    }), {\r\n    \"class\": \"icon-btn underline-side\"\r\n})\r\n\r\nexport class PagingView extends HTMLElement {\r\n    #elements = {}\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        this.#elements.input = el(\"input\", \"1\", {\r\n            type: \"number\",\r\n            min: 1,\r\n            max: 1,\r\n        })\r\n        this.#elements.maxPage = el(\"span\", \"1\")\r\n        const prevBtn = this.#elements.prevBtn = btn(languageSelector(\"上一页\", \"Prev\"))\r\n        const nextBtn = this.#elements.nextBtn = btn(languageSelector(\"下一页\", \"Next\"))\r\n        prevBtn.id = \"prev-btn\"; prevBtn.classList.add(\"left\")\r\n        nextBtn.id = \"next-btn\"; nextBtn.classList.add(\"right\")\r\n\r\n        const labelEl = el(\"label\", [\r\n            this.#elements.input,\r\n            el(\"text\", \"/\"),\r\n            this.#elements.maxPage,\r\n        ])\r\n        this.#appendEvent()\r\n        for (const el of [prevBtn, labelEl, nextBtn]) {\r\n            this.appendChild(el)\r\n        }\r\n    }\r\n    #appendEvent() {\r\n        this.#elements.input.addEventListener(\"keydown\", e => {\r\n            if (e.key !== \"Enter\") {\r\n                return\r\n            }\r\n            const targetPageStr = e.target.value\r\n            if (!/^\\d+$/.test(targetPageStr)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            const targetPage = Number(targetPageStr)\r\n            if (!(targetPage > 0 && targetPage <= this.#elements.input.max)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            pageController.jumpTo(targetPage)\r\n            hashChangeEvent()\r\n        })\r\n        this.#elements.prevBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() > 0) {\r\n                pageController.prev()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n        this.#elements.nextBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() < this.#elements.input.max) {\r\n                pageController.next()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n    }\r\n    setPage(current, total) {\r\n        let isFirstPage = false\r\n        let isLastPage  = false\r\n        let isOnlyPage  = false\r\n        if (total === 1) {\r\n            isOnlyPage = true\r\n        } else {\r\n            if (current === 1) {\r\n                isFirstPage = true\r\n            }\r\n            if (current === total) {\r\n                isLastPage = true\r\n            }\r\n        }\r\n        this.#elements.prevBtn.disabled = isOnlyPage || isFirstPage\r\n        this.#elements.nextBtn.disabled = isOnlyPage || isLastPage\r\n        this.#elements.maxPage.textContent = total\r\n        this.#elements.input.value = current\r\n        this.#elements.input.max   = total\r\n        this.classList.toggle(\"hidden\", isOnlyPage)\r\n    }\r\n}\r\ncustomElements.define(\"paging-view\", PagingView)\r\n","import pageController from \"../components/paging.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport pathManager from \"./pathManager.js\"\r\n\r\nconst mainEl       = document.querySelector(\"main\")\r\n/** @type {HTMLElement | null} */\r\nconst newest       = mainEl.querySelector(\"#newest\")\r\n/** @type {HTMLElement} */\r\nconst parentDirBtn = mainEl.querySelector(\"#previous-dir\")\r\n/** @type {HTMLElement} */\r\nconst articleList  = mainEl.querySelector(\"#article-list\")\r\n\r\nnewest && (newest.onkeydown = keydownEvent(newest))\r\nparentDirBtn.onkeydown = keydownEvent(parentDirBtn)\r\nparentDirBtn.addEventListener(\"click\", () => {\r\n    pageController.back()\r\n    pathManager.jumpTo(pathManager.parent())\r\n})\r\narticleList.addEventListener(\"click\", e => {\r\n    const target = e.target\r\n    if (!(target instanceof HTMLElement)) return\r\n\r\n    if (target === articleList) {\r\n        // when click on the `articleList` itself, ignore this event.\r\n        return\r\n    }\r\n\r\n    const relativeData = target.getAttribute(\"data-relative\")\r\n    const jumpToData = target.getAttribute(\"data-jumpto\")\r\n    if (relativeData) {\r\n        if (relativeData.endsWith(\"/\")) {\r\n            pageController.open()\r\n        }\r\n        pathManager.open(relativeData)\r\n    }\r\n    if (jumpToData) {\r\n        // in `newest` page\r\n        pageController.open()\r\n        pathManager.jumpTo(\"static/\" + jumpToData)\r\n    }\r\n})\r\n","function isOnPreviewServer() {\r\n    const hostname = location.hostname\r\n    return hostname === \"localhost\"\r\n        || hostname === \"127.0.0.1\"\r\n        || hostname.startsWith(\"192.168.\")\r\n}\r\n\r\nexport class LiveReloadWSClient {\r\n    ws = null\r\n    wsServerURL   = \"ws://\" + location.host\r\n    isConnected   = false\r\n    retryCount    = 0\r\n    retryInterval = LiveReloadWSClient.defaultRetryInterval\r\n\r\n    connect() {\r\n        if (!LiveReloadWSClient.isAbleToConnect) return\r\n        const socket = this.ws = new WebSocket(this.wsServerURL)\r\n        socket.addEventListener(\"open\", () => {\r\n            this.retryCount  = 0\r\n            this.retryInterval = LiveReloadWSClient.defaultRetryInterval\r\n            this.isConnected = true\r\n            console.log(\"[LiveReload] WebSocket connected.\")\r\n        })\r\n        socket.addEventListener(\"message\", event => {\r\n            console.log(\"[LiveReload] WebSocket signal received: \", event)\r\n            if (event.data === \"refresh\") {\r\n                location.reload()\r\n            }\r\n        })\r\n        socket.addEventListener(\"error\", event => {\r\n            console.error(\"[LiveReload] WebSocket error occurred:\", event)\r\n            this.close()\r\n        })\r\n        socket.addEventListener(\"close\", event => {\r\n            console.warn(\"[LiveReload] WebSocket connection closed.\")\r\n            this.close()\r\n            if (event.code !== 1000) {\r\n                this.reconnect()\r\n            }\r\n        })\r\n    }\r\n    reconnect() {\r\n        if (this.isConnected) {\r\n            return\r\n        }\r\n        // increase retry interval by disconnected duration\r\n        if (this.retryCount > 10 && this.retryCount <= 20) {\r\n            this.retryInterval = 2 * LiveReloadWSClient.defaultRetryInterval\r\n        } else if (this.retryCount > 20) {\r\n            this.retryInterval = 4 * LiveReloadWSClient.defaultRetryInterval\r\n        } else {\r\n            this.retryInterval = LiveReloadWSClient.defaultRetryInterval\r\n        }\r\n\r\n        // try to reconnect every 1 second\r\n        setTimeout(() => {\r\n            this.retryCount += 1\r\n            this.connect()\r\n        }, this.retryInterval)\r\n    }\r\n    close() {\r\n        this.isConnected = false\r\n        this.ws && this.ws.close()\r\n        this.ws = null\r\n    }\r\n\r\n    static isAbleToConnect = isOnPreviewServer() && (\"WebSocket\" in window)\r\n    static defaultRetryInterval = 1000\r\n}\r\n","import \"./styles/style.css\"\r\nimport \"./styles/components/skeleton.css\"\r\n\r\nimport \"./scripts/mainManager.js\"\r\nimport pageController from \"./components/paging.js\"\r\nimport pathManager, { hashChangeEvent } from \"./scripts/pathManager.js\"\r\nimport { setIframeTheme } from \"./scripts/iframeController.js\"\r\nimport importStyle from \"./scripts/importers/style.js\"\r\nimport { config } from \"./utils/loadConfig.js\"\r\nimport keydownEvent from \"./utils/dom/keydownEvent.js\"\r\nimport { LiveReloadWSClient } from \"./utils/liveReload.js\"\r\nimport eventbus from \"../common/eventbus/inst.js\"\r\nimport isEnabled from \"../common/isEnabled.js\"\r\n\r\nimportStyle(\"dist/chunks/skeleton.min.css\")\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", hashChangeEvent)\r\nif (document.readyState !== \"loading\") hashChangeEvent()\r\n\r\n// import optional components\r\nif (isEnabled(config.fab)) import(\"./components/fab.js\")\r\nif (isEnabled(config.search)) import(\"./components/searchBox.js\")\r\nif (isEnabled(config.catalog)) {\r\n    function passEvent() {\r\n        if (isToShow) {\r\n            eventbus.emit(\"article-rendered\", items)\r\n        }\r\n    }\r\n    let isLoaded = false\r\n    let isToShow = false\r\n    let items = null\r\n    import(\"./components/catalog.js\")\r\n        .then(() => isLoaded = true)\r\n        .then(passEvent)\r\n    \r\n    eventbus.on(\"article-rendered\", _items => {\r\n        if (!isLoaded) {\r\n            isToShow = true\r\n            items = _items\r\n        }\r\n    })\r\n}\r\n\r\n// set theme switcher button event\r\nconst searchBtn = document.getElementById(\"search-btn\")\r\nconst lightBtn  = document.getElementById(\"light-btn\")\r\nconst darkBtn   = document.getElementById(\"dark-btn\")\r\nsearchBtn.onclick  = () => eventbus.emit(\"searchbox-show\")\r\nlightBtn.onkeydown = keydownEvent(lightBtn)\r\ndarkBtn.onkeydown  = keydownEvent(darkBtn)\r\n\r\n// --- --- --- --- --- ---\r\n\r\nwindow.addEventListener(\"popstate\", () => {\r\n    if (location.hash.endsWith(\"/\")) {\r\n        // in a directory\r\n        pageController.back()\r\n    }\r\n})\r\n\r\nwindow.addEventListener(\"beforeunload\", e => {\r\n    if (!pathManager.isIn.article()) {\r\n        return\r\n    }\r\n    // when leave an article remember current scroll position\r\n    sessionStorage.setItem(\"last-leave-page\", location.hash)\r\n    sessionStorage.setItem(\"last-leave-position\", window.scrollY)\r\n})\r\n\r\n// set embedded iframe theme\r\nconst darkmodeObserver = new MutationObserver(setIframeTheme)\r\ndarkmodeObserver.observe(document.body, {\r\n    attributes: true,\r\n    attributeFilter: [\"class\"]\r\n})\r\n\r\n// set embedded iframe height\r\nwindow.addEventListener(\"message\", e => {\r\n    if (e.origin != \"null\") {\r\n        return\r\n    }\r\n    const { id, height } = e.data\r\n    const targetIframeEl = document.getElementById(id)\r\n    targetIframeEl.style.height = height + \"px\"\r\n})\r\n\r\nconst wsClient = new LiveReloadWSClient()\r\nwsClient.connect()\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n    // if support service worker, register\r\n    navigator.serviceWorker\r\n        .register(\"./sw.js\")\r\n        .catch(function(error) {\r\n            // registration failed\r\n            console.error(\"Registration failed with \" + error);\r\n        })\r\n}\r\n"],"names":["controller","async","fetchJSON","path","abort","AbortController","fetch","signal","then","json","res","catch","err","console","log","error","importStyle","Promise","resolve","reject","linkEl","document","createElement","rel","href","head","appendChild","onload","onerror","inst","DynamicImporter","name","_targetElList","querySelectorAll","importLangDefs","languageList","langDefImporters","filter","this","_module","getLanguage","map","lang","__variableDynamicImportRuntime0__","toLowerCase","all","langDefs","forEach","defModule","index","def","default","registerLanguage","loadErrResolver","loadCondition","size","renderItem","el","highlightElement","beforeRender","Set","Array","from","importModule","import","highlightRender","render","bind","katexOptions","config","isContainsFormula","renderErrResolver","texString","textContent","ParseError","innerHTML","message","replace","renderErrMsg","katexRender","umdImporter","scriptEl","src","type","globalThis","errMsg","localModuleObj","undefined","raphael","flowchartOptions","ChartImporter","constructor","super","chartContent","parse","drawSVG","flowchartRender","diagram","dom","SequenceDiagram","sequenceChartRender","language","ganttOptions","globalOptions","ganttChartRender","railroadRenderOptions","railroadOptions","ASCIIPattern","CJKPattern","CHAR_WIDTH_before","CHAR_WIDTH","containsCJK","test","isAllContainsASCII","match","matchItem","slice","every","item","targetCharWidth","renderArgs","concat","Function","apply","module","rr","Options","Object","assign","obj","newObj","key","hasOwnProperty","removeUndefinedFields","VS","verticalGap","AR","arcRadius","INTERNAL_ALIGNMENT","internalAlignment","charWidth","COMMENT_CHAR_WIDTH","commentCharWidth","Diagram","ComplexDiagram","Sequence","Stack","OptionalSequence","AlternatingSequence","Choice","HorizontalChoice","MultipleChoice","Optional","OneOrMore","ZeroOrMore","Group","Start","End","Terminal","NonTerminal","Comment","Skip","Block","railroadChartRender","qrcodeOptions","darkmodeObserver","MutationObserver","renderAll","computedStyle","getComputedStyle","body","frontColor","getPropertyValue","backgroundColor","instOptions","qrcodeContent","__QRCodeContent__","qrcodeWidth","width","color","background","content","Error","qrcodeInst","style","svg","QRCode","observe","attributes","attributeFilter","qrcodeRender","chartMethodMap","Map","echartsRender","chartRender","chartTypeList","has","targetChartLoadMethod","get","embeddedIframes","setIframeRem","fontSize","contentWindow","postMessage","setIframeTheme","theme","classList","contains","propToString","props","entries","_","val","join","replaceAll","toString","htmlValueFormater","selfClosingTag","tagName","createTextNode","targetEl","setAttribute","propSetter","childEl","HTMLElement","contentSetter","patternList","tokenize","para","length","pattern","reduce","accumulator","current","getInterval","text","startSign","endSign","includeEscape","includes","intervalText","signCount","isEscape","ch","substr","KeyToken_TagName_map","PairedParenMap","katexRenderer","window","renderModule","TextToken","count","countWord","toHTML","KeyToken","tagSign","tag","realTagName","className","split","__ContainsFormula__","countEntry","formulaImage","class","elOption","parseEntry","LinkToken","address","displayContent","URL","target","startsWith","base","location","hash","__ResourcePath__","resolvePathname","PhoneticToken","notation","ignoredLeftParenthesis","ignoredRightParenthesis","notationEl","DetailToken","detail","detailEl","onclick","e","stopPropagation","toggleAttribute","parser","source","getFirstChar","charAt","substring","getSpecialTokenClass","tokenSign","targetTokenType","tokens","textTerm","keyTerm","keyStart","isInKey","nextCh","push","specialTokenSign","pairedTokenSign","removedContent","hiddenContent","resultHTML","token","htmlEntityReplace","Headline","splited","numberSignStr","numberSignCount","Math","min","rawContent","options","id","parsedContent","static","Para","trimStart","inline","EmptyLine","Quote","children","title","NormalTypeEnum","alertPattern","defaultTitle","titleLine","targetType","NoteTypeEnum","languageSelector","TipTypeEnum","ImportantTypeEnum","warningTypeEnum","CautionTypeEnum","titleString","node","headline","innerNodes","description","Symbol","Divider","List","isOrdered","orderedPattern","getContent","childrenHTML","child","unorderedPattern","line","taskListPattern","trimedLine","TaskListItem","prefix","isChecked","checkedSignList","inputEl","checked","QABlock","elements","element","Question","Answer","Table","headerCells","bodyRows","tableHeaderCell","tableBodyCell","tableHeaderRow","row","tableBodyRow","tableHeader","tableBody","MediaNode","mdText","containerGenerator","patternGenerator","identifierSign","endsWith","replaceContentGenerator","srcUrlResolver","rawUrl","Image","actualUrl","isDrawioDiagram","imageEl","alt","loading","tabindex","open","add","parentNode","remove","Audio","audioEl","controls","Video","videoEl","isIframePattern","Iframe","iframeEl","sandbox","CodeBlock","isPlaintext","langName","langClass","__LanguageList__","toUpperCase","codeEl","DetailsBlock","summary","summaryEl","detailsEl","childrenEl","FormulaBlock","IframeBlock","__IframeCounter__","injectedCodes","srcdoc","EchartsChartType","chartOptions","__ChartTypeList__","chartEl","__ChartOptions__","FlowChartType","__ChartContent__","SequenceChartType","GanttChartType","RailroadChartType","QRCodeType","UnknownChartType","ChartBlock","getIndent","indentCount","spaceCount","listResolver","currentLine","lines","currentIndent","currentNode","isListPattern","nextLine","shift","nextIndent","isNextOrdered","unshift","quoteResolver","firstLine","quotedContent","l","mdResolver","tableLineConverter","tableLine","trim","tableResolver","headerText","contentLines","contentRows","QAResolver","block","isQuestion","isAnswer","blockResolverGenerator","targetClass","codeResolver","chartResolver","formulaResolver","detailsResolver","resolver","iframeResolver","indexOf","getLines","nodes","keydownEvent","click","currentScrollTop","scrollY","documentElement","scrollTop","scrollToPos","pos","scroll","top","behavior","scrollToEl","offset","offsetTop","scrollToTop","ensureScrollTo","scrollController","predicate","debounced","debounce","abs","scrollHeight","clientHeight","removeEventListener","addEventListener","isEnabled","enable","emptyArticlePlaceHolder","articleRender","articleEl","structure","catalog","headlineItems","level","getHeadlines","eventbus","emit","resultNodes","fragment","createDocumentFragment","loadEvents","allIframeLoaded","onkeydown","lastLeavePage","sessionStorage","getItem","lastLeavePos","removeItem","targetScrollPos","Number","parseInt","String","dateFormatter","timestamp","date","Date","Intl","DateTimeFormat","format","newestItemRenderer","titleEl","dateEl","createTime","link","directoryItemRenderer","modifyTime","mainEl","querySelector","articleList","dirDescriptionEl","updateTimeEl","pagingComponent","indexRender","itemResolver","total","updateTime","setPage","dirDescription","dynamicPrefetch","as_","as","newestHeader","directoryHeader","getIndexPathFromHash","pageController","hashChangeEvent","pathManager","homepage","isIn","newestPage","newestIndex","directory","contents","currentHash","tasks","targetIndexPath","prefetchResources","article","articleContent","status","DOMException","fetchMD","getHash","url","HashChangeEvent","oldURL","newURL","homepagePath","jumpTo","parent","root","testTarget","pageList","next","prev","targetPage","back","pop","btn","PagingView","input","max","maxPage","prevBtn","nextBtn","labelEl","appendEvent","targetPageStr","value","isFirstPage","isLastPage","isOnlyPage","disabled","toggle","customElements","define","newest","parentDirBtn","relativeData","getAttribute","jumpToData","LiveReloadWSClient","ws","wsServerURL","host","isConnected","retryCount","retryInterval","defaultRetryInterval","connect","isAbleToConnect","socket","WebSocket","event","data","reload","close","warn","code","reconnect","setTimeout","hostname","isOnPreviewServer","readyState","fab","search","passEvent","isToShow","items","isLoaded","on","_items","searchBtn","getElementById","lightBtn","darkBtn","setItem","origin","height","navigator","serviceWorker","register"],"mappings":"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"}